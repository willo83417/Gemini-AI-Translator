
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

const resources = {
  en: {
    translation: {
      languages: {
        autoDetect: 'Auto Detect',
        english: 'English',
        chineseTraditional: 'Chinese (Traditional)',
        chineseTraditionalHK: 'Chinese (Traditional) HK',
        chineseSimplified: 'Chinese (Simplified)',
        spanish: 'Spanish',
        japanese: 'Japanese',
        french: 'French',
        german: 'German',
        korean: 'Korean',
        russian: 'Russian',
        portuguese: 'Portuguese',
        italian: 'Italian',
      },
      translationInput: {
        online: 'Online',
        offline: 'Offline',
        cameraAriaLabel: 'Translate from camera',
        settingsAriaLabel: 'Open settings',
        placeholderListening: 'Listening...',
        placeholderEnterText: 'Enter text to translate',
        clearText: 'Clear text',
        countdownPrefix: '0:',
        recordingStop: 'Stop recording',
        recordingStart: 'Start recording',
        cancelTranslation: 'Cancel Translation',
        translateOffline: 'Translate using offline model',
        translate: 'Translate',
        countdown: 'Time left: {{seconds}}s',
      },
      translationOutput: {
        modeOnline: 'Mode: Online ({{provider}})',
        modeOfflineInitializing: 'Mode: Offline ({{modelName}}) - Initializing...',
        modeOfflineReady: 'Mode: Offline ({{modelName}})',
        modeOfflineNotReady: 'Mode: Offline ({{modelName}}) - Model not ready',
        modeOfflineNoModel: 'Mode: Offline - No model selected',
        flipScreenAriaLabel: 'Flip screen',
        copyAriaLabel: 'Copy translated text',
        historyAriaLabel: 'View translation history',
        clearAriaLabel: 'Clear translated text',
        placeholder: 'Translation',
        speakStop: 'Stop speaking',
        speakCustomVoice: 'Speak with custom voice',
        speakFemale: 'Speak with female voice',
        speakMale: 'Speak with male voice',
        astStop: 'Stop speech translation',
        astStart: 'Start speech translation',
        astTitle: 'Automatic Speech Translation',
      },
      settings: {
        title: 'Settings',
        closeAriaLabel: 'Close settings',
        tabOnline: 'Online',
        tabOffline: 'Offline AI',
        tabSpeech: 'Speech',
        tabTts: 'Offline TTS',
        tabOfflineParams: 'Offline Params',
        tabOcr: 'PaddleOCR',
        subTabModels: 'LLM Models',
        subTabParameters: 'Model Parameters',
        providerLabel: 'Provider',
        providerGemini: 'Gemini',
        providerOpenAI: 'OpenAI',
        openaiUrlLabel: 'OpenAI API URL',
        openaiUrlPlaceholder: 'e.g., https://api.openai.com',
        apiKeyLabel: 'API Key',
        apiKeyPlaceholder: 'Enter your Gemini or OpenAI API Key',
        modelNameLabel: 'Model Name',
        modelNameGeminiPlaceholder: 'e.g., gemini-2.5-flash',
        modelNameOpenAIPlaceholder: 'e.g., gpt-4o',
        hfApiKeyLabel: 'Hugging Face API Key',
        hfApiKeyPlaceholder: 'Required to download models',
        hfApiKeyDescription: 'A key is required for model downloads from Hugging Face.',
        manageModelsLabel: 'Select & Download Offline LLM Model',
        addCustomModelTitle: 'Add Custom Model',
        customModelUrlLabel: 'Hugging Face Model URL',
        customModelUrlPlaceholder: 'e.g., https://huggingface.co/org/repo',
        customModelLibUrlLabel: 'Model Library URL (.wasm)',
        customModelLibUrlPlaceholder: 'e.g., https://.../lib.wasm',
        addCustomModelButton: 'Download and Use Custom Model',
        asrModelLabel: 'Select & Download Offline Speech Recognition Model (ASR)',
        ocrModelLabel: 'Select OCR Model',
        initializeOcr: 'Initialize OCR Engine',
        switchOcr: 'Switch/Reload OCR Model',
        download: 'Download',
        pause: 'Pause',
        resume: 'Resume',
        retry: 'Retry',
        deleteModelAriaLabel: 'Delete {{modelName}}',
        modelCached: 'Cached',
        modelDownload: 'Download',
        modelDownloading: 'Downloading...',
        statusInitializing: 'Initializing...',
        statusError: 'Error: {{error}}',
        enableOfflineLabel: 'Enable Offline Translation',
        enableOfflineDescription: 'Use local model for translations.',
        enableWebSpeechLabel: 'Web Speech API',
        enableWebSpeechDescription: 'Use browser\'s built-in recognition (Online).',
        enableOfflineAsrLabel: 'Offline ASR (Whisper)',
        enableOfflineAsrDescription: 'Use local Whisper model. Works with Online & Offline translation.',
        enableGemmaAudioLabel: 'Gemma 3N Native Audio',
        enableGemmaAudioDescription: 'Use LLM\'s native audio capability. Requires Offline Translation Mode.',
        enableTwoStepLabel: 'High-Accuracy JP→ZH Mode',
        enableTwoStepDescription: 'Improves Japanese to Chinese translation via English.',
        audioProcessingLabel: 'Audio Processing (Whisper)',
        enableNoiseCancellationLabel: 'Noise Cancellation',
        enableNoiseCancellationDescription: 'Reduce background noise.',
        audioGainLabel: 'Microphone Gain',
        clearCacheButton: 'Clear LLM Cache',
        clearCacheDescription: 'Remove all downloaded LLM models.',
        clearAsrCacheButton: 'Clear ASR Cache',
        ttsSettingsLabel: 'Text-to-Speech (TTS) Settings',
        enableCustomTtsLabel: 'Enable Custom Offline TTS',
        enableCustomTtsDescription: 'Customize the voice for text-to-speech.',
        voiceLabel: 'Voice',
        voicePlaceholder: 'No voices available for {{languageName}}',
        rateLabel: 'Rate',
        pitchLabel: 'Pitch',
        offlineParamsDescription: 'Advanced parameters for the local offline model. Changes will require the model to be re-initialized.',
        maxTokensLabel: 'Max Tokens',
        topKLabel: 'Top K',
        temperatureLabel: 'Temperature',
        randomSeedLabel: 'Random Seed',
        supportAudioLabel: 'Enable Audio Input (Gemma)',
        supportAudioDescription: 'Allows the model to process audio files.',
        maxNumImagesLabel: 'Enable Image Input (for OCR)',
        maxNumImagesDescription: 'Allows the model to process one image.',
        clearSettingsButton: 'Clear All Settings',
        saveSettingsButton: 'Save Settings',
        languageLabel: 'UI Language',
        clearAllAriaLabel: 'Clear all settings and cached models',
      },
      history: {
        title: 'Translation History',
        closeAriaLabel: 'Close history',
        empty: 'No history yet.',
        selectAriaLabel: 'Select translation from {{sourceLang}} to {{targetLang}}',
        clearAriaLabel: 'Clear all translation history',
        clearButton: 'Clear History',
      },
      camera: {
        title: 'Camera Translation View',
        closeAriaLabel: 'Close camera view',
        errorAccess: 'Could not access the camera. Please ensure permissions are granted.',
        errorCapture: 'Failed to capture image: {{message}}',
        errorLoad: 'Failed to load image: {{message}}',
        zoomAriaLabel: 'Zoom camera',
        galleryAriaLabel: 'Import from gallery',
        captureAriaLabel: 'Capture and process image',
        processingAriaLabel: 'Processing image',
        flashOffAriaLabel: 'Turn on flash',
        flashOnAriaLabel: 'Turn off flash',
      },
      notifications: {
        offlineModelInitSuccess: 'Offline model {{modelIdentifier}} initialized successfully.',
        offlineModelInitFailed: 'Failed to load offline model.',
        translationFailed: 'Translation Failed: {{errorMessage}}',
        speechError: 'Speech synthesis error: {{error}}',
        speechRecognitionError: 'Speech recognition error: {{error}}',
        mediaRecorderUnsupported: 'MediaRecorder API is not supported in this browser.',
        processingAudio: '[Processing audio...]',
        noAudioRecorded: 'No audio was recorded.',
        transcriptionFailed: 'Transcription Failed: {{errorMessage}}',
        micPermissionError: 'Could not start recording. Please grant microphone permissions.',
        offlineModelNotReadyRecording: 'Offline model is not ready for recording.',
        offlineSRError: 'You are offline. Cannot use online speech recognition.',
        astFailed: 'AST Failed: {{errorMessage}}',
        astSelectLanguage: 'Please select a source language before using speech translation.',
        astOfflineModelNotReady: 'Offline model is not ready for speech translation.',
        astOfflineError: 'You are offline. Cannot use online speech translation.',
        processingImage: '[Processing image...]',
        offlineImageError: 'Offline model is not ready for image processing.',
        noTextInImage: 'No text found in the image.',
        offlineImageTranslateError: 'You are offline. Cannot use online image translation.',
        imageProcessingFailed: 'Image Processing Failed: {{errorMessage}}',
        offlineFeatureUnavailable: 'This feature is not available in offline mode.',
        cacheCleared: 'Offline model cache has been cleared successfully.',
        downloadInProgress: 'A model is already being downloaded. Please wait.',
        modelDownloaded: 'Model {{modelId}} downloaded successfully.',
        modelDeleted: 'Model {{modelId}} deleted successfully.',
        customModelUrlError: 'Please provide both the model URL and the model library URL.',
        customModelSelected: 'Custom model has been selected.',
        cacheClearError: 'Please enable offline mode and select a model before clearing the cache.',
        transcribing: '[Transcribing...]',
        transcribingApi: '[Transcribing via API...]',
        asrReady: 'Speech recognition model is ready.',
        asrFailed: 'Failed to initialize speech recognition model: {{error}}',
        asrModelDeleted: 'ASR model cache cleared successfully.',
        asrModelUnloaded: 'Offline speech model unloaded successfully.',
        asrOnlineUnavailable: 'Offline ASR is only available in Offline Translation Mode.',
        modelIdleUnloaded: 'Offline model unloaded due to inactivity to save resources. It will reload on next use.',
        ocrNotReady: 'OCR engine not ready. Please initialize it in Settings > PaddleOCR v5.',
      },
      common: {
        status: {
          not_started: 'Not Started',
          downloading: 'Downloading',
          paused: 'Paused',
          completed: 'Completed',
          error: 'Error',
          consolidating: 'Consolidating...',
          initializing: 'Initializing...',
        },
      },
    },
  },
  'zh-TW': {
    translation: {
      languages: {
        autoDetect: '自動偵測',
        english: '英文',
        chineseTraditional: '繁體中文',
        chineseTraditionalHK: '繁體中文 (香港)',
        chineseSimplified: '簡體中文',
        spanish: '西班牙文',
        japanese: '日文',
        french: '法文',
        german: '德文',
        korean: '韓文',
        russian: '俄文',
        portuguese: '葡萄牙文',
        italian: '義大利文',
      },
      translationInput: {
        online: '線上',
        offline: '離線',
        cameraAriaLabel: '使用相機翻譯',
        settingsAriaLabel: '開啟設定',
        placeholderListening: '正在聆聽...',
        placeholderEnterText: '輸入要翻譯的文字',
        clearText: '清除文字',
        countdownPrefix: '0:',
        recordingStop: '停止錄音',
        recordingStart: '開始錄音',
        cancelTranslation: '取消翻譯',
        translateOffline: '使用離線模型翻譯',
        translate: '翻譯',
        countdown: '剩餘時間：{{seconds}}秒',
      },
      translationOutput: {
        modeOnline: '模式：線上 ({{provider}})',
        modeOfflineInitializing: '模式：離線 ({{modelName}}) - 初始化中...',
        modeOfflineReady: '模式：離線 ({{modelName}})',
        modeOfflineNotReady: '模式：離線 ({{modelName}}) - 模型未就緒',
        modeOfflineNoModel: '模式：離線 - 未選擇模型',
        flipScreenAriaLabel: '翻轉螢幕',
        copyAriaLabel: '複製翻譯結果',
        historyAriaLabel: '檢視翻譯歷史',
        clearAriaLabel: '清除翻譯結果',
        placeholder: '翻譯結果',
        speakStop: '停止朗讀',
        speakCustomVoice: '使用自訂語音朗讀',
        speakFemale: '使用女聲朗讀',
        speakMale: '使用男聲朗讀',
        astStop: '停止語音翻譯',
        astStart: '開始語音翻譯',
        astTitle: '即時語音翻譯',
      },
      settings: {
        title: '設定',
        closeAriaLabel: '關閉設定',
        tabOnline: '線上',
        tabOffline: '離線AI',
        tabSpeech: '語音',
        tabTts: '離線 TTS',
        tabOfflineParams: '離線參數',
        tabOcr: 'PaddleOCR',
        subTabModels: 'LLM 模型',
        subTabParameters: '模型參數',
        providerLabel: '服務提供商',
        providerGemini: 'Gemini',
        providerOpenAI: 'OpenAI',
        openaiUrlLabel: 'OpenAI API URL',
        openaiUrlPlaceholder: '例如：https://api.openai.com',
        apiKeyLabel: 'API 金鑰',
        apiKeyPlaceholder: '輸入您的 Gemini 或 OpenAI API 金鑰',
        modelNameLabel: '模型名稱',
        modelNameGeminiPlaceholder: '例如：gemini-2.5-flash',
        modelNameOpenAIPlaceholder: '例如：gpt-4o',
        hfApiKeyLabel: 'Hugging Face API 金鑰',
        hfApiKeyPlaceholder: '下載模型需要金鑰',
        hfApiKeyDescription: '從 Hugging Face 下載模型需要金鑰。',
        manageModelsLabel: '選擇並下載離線 LLM 模型',
        addCustomModelTitle: '新增自訂模型',
        customModelUrlLabel: 'Hugging Face 模型 URL',
        customModelUrlPlaceholder: '例如：https://huggingface.co/org/repo',
        customModelLibUrlLabel: '模型庫 URL (.wasm)',
        customModelLibUrlPlaceholder: '例如：https://.../lib.wasm',
        addCustomModelButton: '下載並使用自訂模型',
        asrModelLabel: '選擇並下載離線語音辨識模型 (ASR)',
        ocrModelLabel: '選擇 OCR 模型',
        initializeOcr: '初始化 OCR 引擎',
        switchOcr: '切換/重載 OCR 模型',
        modelCached: '已快取',
        modelDownload: '下載',
        modelDownloading: '下載中...',
        deleteModelAriaLabel: '刪除 {{modelName}}',
        download: '下載',
        pause: '暫停',
        resume: '繼續',
        retry: '重試',
        statusInitializing: '初始化中...',
        statusError: '錯誤：{{error}}',
        enableOfflineLabel: '啟用離線翻譯',
        enableOfflineDescription: '使用本機模型進行翻譯。',
        enableWebSpeechLabel: 'Web Speech API',
        enableWebSpeechDescription: '使用瀏覽器內建辨識 (線上)。',
        enableOfflineAsrLabel: '離線 ASR (Whisper)',
        enableOfflineAsrDescription: '使用本機 Whisper 模型。可搭配線上或離線翻譯。',
        enableGemmaAudioLabel: 'Gemma 3N 原生音訊',
        enableGemmaAudioDescription: '使用 LLM 原生音訊能力。僅限離線翻譯模式。',
        enableTwoStepLabel: '高準確度 日→中 模式',
        enableTwoStepDescription: '透過英文中轉，提升日文到中文的翻譯品質。',
        audioProcessingLabel: '音訊處理 (Whisper)',
        enableNoiseCancellationLabel: '降噪',
        enableNoiseCancellationDescription: '減少背景噪音。',
        audioGainLabel: '麥克風增益',
        clearCacheButton: '清除 LLM 快取',
        clearCacheDescription: '移除所有已下載的 LLM 模型。',
        clearAsrCacheButton: '清除 ASR 快取',
        ttsSettingsLabel: '文字轉語音 (TTS) 設定',
        enableCustomTtsLabel: '啟用自訂離線 TTS',
        enableCustomTtsDescription: '自訂文字轉語音的聲音。',
        voiceLabel: '語音',
        voicePlaceholder: '沒有適用於 {{languageName}} 的語音',
        rateLabel: '速率',
        pitchLabel: '音高',
        offlineParamsDescription: '進階離線模型參數。更改後模型需要重新初始化。',
        maxTokensLabel: '最大權杖數 (Max Tokens)',
        topKLabel: 'Top K',
        temperatureLabel: '溫度 (Temperature)',
        randomSeedLabel: '隨機種子 (Random Seed)',
        supportAudioLabel: '啟用音訊輸入 (Gemma)',
        supportAudioDescription: '允許模型處理音訊檔案。',
        maxNumImagesLabel: '啟用圖片輸入 (用於文字擷取)',
        maxNumImagesDescription: '允許模型處理一張圖片。',
        clearSettingsButton: '清除所有設定',
        saveSettingsButton: '儲存設定',
        languageLabel: '介面語言',
        clearAllAriaLabel: '清除所有設定和快取模型',
      },
      history: {
        title: '翻譯歷史',
        closeAriaLabel: '關閉歷史紀錄',
        empty: '尚無歷史紀錄。',
        selectAriaLabel: '選擇從 {{sourceLang}} 到 {{targetLang}} 的翻譯',
        clearAriaLabel: '清除所有翻譯歷史',
        clearButton: '清除歷史',
      },
      camera: {
        title: '相機翻譯畫面',
        closeAriaLabel: '關閉相機畫面',
        errorAccess: '無法存取相機。請確認已授予權限。',
        errorCapture: '擷取影像失敗：{{message}}',
        errorLoad: '載入影像失敗：{{message}}',
        zoomAriaLabel: '縮放相機',
        galleryAriaLabel: '從相簿匯入',
        captureAriaLabel: '擷取並處理影像',
        processingAriaLabel: '正在處理影像',
        flashOffAriaLabel: '開啟閃光燈',
        flashOnAriaLabel: '關閉閃光燈',
      },
      notifications: {
        offlineModelInitSuccess: '離線模型 {{modelIdentifier}} 初始化成功。',
        offlineModelInitFailed: '載入離線模型失敗。',
        translationFailed: '翻譯失敗：{{errorMessage}}',
        speechError: '語音合成錯誤：{{error}}',
        speechRecognitionError: '語音辨識錯誤：{{error}}',
        mediaRecorderUnsupported: '此瀏覽器不支援 MediaRecorder API。',
        processingAudio: '[正在處理音訊...]',
        noAudioRecorded: '未錄製到任何音訊。',
        transcriptionFailed: '語音轉文字失敗：{{errorMessage}}',
        micPermissionError: '無法開始錄音。請授予麥克風權限。',
        offlineModelNotReadyRecording: '離線模型尚未準備好進行錄音。',
        offlineSRError: '您處於離線狀態，無法使用線上語音辨識。',
        astFailed: '語音翻譯失敗：{{errorMessage}}',
        astSelectLanguage: '使用語音翻譯前，請先選擇來源語言。',
        astOfflineModelNotReady: '離線模型尚未準備好進行語音翻譯。',
        astOfflineError: '您處於離線狀態，無法使用線上語音翻譯。',
        processingImage: '[正在處理影像...]',
        offlineImageError: '離線模型尚未準備好進行影像處理。',
        noTextInImage: '影像中未找到文字。',
        offlineImageTranslateError: '您處於離線狀態，無法使用線上影像翻譯。',
        imageProcessingFailed: '影像處理失敗：{{errorMessage}}',
        offlineFeatureUnavailable: '此功能在離線模式下不可用。',
        cacheCleared: '已成功清除離線模型快取。',
        downloadInProgress: '已有模型正在下載，請稍候。',
        modelDownloaded: '模型 {{modelId}} 下載成功。',
        modelDeleted: '模型 {{modelId}} 刪除成功。',
        customModelUrlError: '請同時提供模型 URL 和模型庫 URL。',
        customModelSelected: '已選擇自訂模型。',
        cacheClearError: '請先啟用離線模式並選擇一個模型，然後再清除快取。',
        transcribing: '[語音轉換文字中...]',
        transcribingApi: '[透過 API 轉換語音中...]',
        asrReady: '語音辨識模型已就緒。',
        asrFailed: '語音辨識模型初始化失敗：{{error}}',
        asrModelDeleted: 'ASR 模型快取已清除成功。',
        asrModelUnloaded: '離線語音模型已成功卸載。',
        asrOnlineUnavailable: '離線 ASR 僅在離線翻譯模式下可用。',
        modelIdleUnloaded: '離線模型因閒置而卸載以節省資源，下次使用時將自動重新載入。',
        ocrNotReady: 'OCR 引擎尚未就緒。請在 設定 > PaddleOCR v5 中進行初始化。',
      },
      common: {
        status: {
          not_started: '未開始',
          downloading: '下載中',
          paused: '已暫停',
          completed: '已完成',
          error: '錯誤',
          consolidating: '整合中...',
          initializing: '初始化中...',
        },
      },
    },
  },
};

i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    resources,
    fallbackLng: 'en',
    debug: true,
    interpolation: {
      escapeValue: false, // React already does escaping
    },
    detection: {
      order: ['localStorage', 'navigator'],
      caches: ['localStorage'],
    },
  });

export default i18n;
